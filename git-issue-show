#!/bin/bash

show() {
    local iss_id=$(iss-id "open" $1)

    local abb=$(git log --pretty=format:%h $iss_id | tail -1 2> /dev/null || echo $iss_id)
    local ref="refs/issues/$iss_id"
    local title=$(git show $ref:title 2> /dev/null)
    [ -z "$title" ] && die "Not a valid issue id"
    echo -e "$abb - $title\n"
    local index=1
    echo git ls-tree --name-only "$ref" msgs/
    git ls-tree --name-only "$ref" msgs/ | while read path; do
	local author=$(git log --pretty=format:"%aN" $ref -- $path | tail -1)
	echo -e "\t$index) $author:"
	git show $ref:$path | while read line; do
	    echo -e "\t\t$line"
	done
	index=$(($index + 1))
	echo
    done
}
